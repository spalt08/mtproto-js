/* eslint-disable max-len */
import { genPasswordSRP } from './srp';
import { hex2raw } from '../serialization';

test('async | getPasswordKdf', () => {
  const salt1 = 'b6cb41e42a56054eb2e8320e30b215c0';
  const salt2 = 'f7951e1b4ac1d1ff6722d4adf1941577';
  const g = 3;
  const p = 'c71caeb9c6b1c9048e6c522f70f13f73980d40238e3e21c14934d037563d930f48198a0aa7c14058229493d22530f4dbfa336f6e0ac925139543aed44cce7c3720fd51f69458705ac68cd4fe6b6b13abdc9746512969328454f18faf8c595f642477fe96bb2a941d5bcd1d4ac8cc49880708fa9b378e3c4f3a9060bee67cf9a4a4a695811051907e162753b56b0f6b410dba74d8a84b2a14b3144e0ef1284754fd17ed950d5965b4b9dd46582db1178d169c6bc465b0d6ff9ca3928fef5b9ae4e418fc15e83ebea0f87fa9ff5eed70050ded2849f47bf959d956850ce929851f0d8115f635b105ee2e4e15d04b2454bf6f4fadf034b10403119cd8e3b92fcc5b';
  const srpId = '3541879028763065224';
  const srpB = '9ac2cd7f80945b9db27737553df8e4dacaa1cd1e18793dbc75d534311ec79a00234becae655b58ca5ef22a34d3898fb1819ca98c3d0daf93ec90ea1156a76522c8a53e94a103a9cc673325f1c3d620f9678c040f3c26c9c409158bea37b50053852c6c0831869d940b7e6909f200adfcd75d0b6fe9119262919909acf77f9abe0f68be3aaa5c6abcb3a7115f65501fb4ebcf3f49506e00f92c335a5b3b827740541b4666dd9ee6645419abfda67af46b34959e401082fc0a8e7264c0ceedfcbc0c8a723671294e052ca0edcddc9a6bc9f5e8b48867d04f3b122883228680946aa9cbcb0a3fea6e618e5099062e36ca9911846156e99f5b2c03b41de3de2c9539';
  const rand = '9153faef8f2bb6da91f6e5bc96bc00860a530a572a0f45aac0842b4602d711f8bda8d59fb53705e4ae3e31a3c4f0681955425f224297b8e9efd898fec22046debb7ba8a0bcf2be1ada7b100424ea318fdcef6ccfe6d7ab7d978c0eb76a807d4ab200eb767a22de0d828bc53f42c5a35c2df6e6ceeef9a3487aae8e9ef2271f2f6742e83b8211161fb1a0e037491ab2c2c73ad63c8bd1d739de1b523fe8d461270cedcf240de8da75f31be4933576532955041dc5770c18d3e75d0b357df9da4a5c8726d4fced87d15752400883dc57fa1937ac17608c5446c4774dcd123676d683ce3a1ab9f7e020ca52faafc99969822717c8e07ea383d5fb1a007ba0d170cb';

  const res = genPasswordSRP(salt1, salt2, g, p, srpId, srpB, 'pas', rand);

  expect(res.srp_id).toBe('3541879028763065224');
  expect(res.A).toBe(hex2raw('5327bf0e6b28d0757fa2ab239caf742c72689095c5dcef0f5429e51a3ca42999aa9b482e720fd9a24be9931aa541060df2f08006d9c4ec587a434d87ab2a5ef61d45e9793957e6d0deaf0c791ebaef55d9f9c1f4ecfc8d57266c459704805ea92437cd839dc8208ce9fab52bf9bd6140e82783b52cc9b632cc3c7a5f356b25281114fccbcff43bb799a6cdd6f668753c26a35f9455186875ad46b045e48905a0a0c9c8f564fa998060d8f3db49769213b049e04ad830750e505d1ecbdacd5bd32091f65919b8a085e3315efca2e1a5eb41a41defbb63ed39c46c99197f44c53b01124bddabf1f6982457f53dc9d3477a6eb745046c709520825c571a63b7dfa1'));
  expect(res.M1).toBe(hex2raw('8647f0c3814dcba9fce53ba40d87920880a413eddccc5995a289f6e08c21512c'));
});
