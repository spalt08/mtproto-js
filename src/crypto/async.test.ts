/* eslint-disable max-len */
import async from './async';
import { hex, Bytes } from '../serialization';

test('async | factorize task', () => {
  async('factorize', '17ED48941A08F981', (pq: string[]) => {
    expect(pq).toEqual(['494c553b', '53911073']);
  });
});

// todo: mock padding
// test('async | encrypt_pq task', () => {
//   const payloadPQ = [
//     hex('ec5ac983081e8c2086985161550000000453da7b1b000000045d426c4f0000002952501249fe86acd26bf3cd21a7f26a0a769a8f752ac700dff54d349c1e0c7828d1fbcba0fa7b13aae3b60ee79e203d1fc27d780c24706facd43d4a41090aca'),
//     {
//       fingerprint: 'a5b7f709355fc30b',
//       n: 'aeec36c8ffc109cb099624685b97815415657bd76d8c9c3e398103d7ad16c9bba6f525ed0412d7ae2c2de2b44e77d72cbf4b7438709a4e646a05c43427c7f184debf72947519680e651500890c6832796dd11f772c25ff8f576755afe055b0a3752c696eb7d8da0d8be1faf38c9bdd97ce0a77d3916230c4032167100edd0f9e7a3a9b602d04367b689536af0d64b613ccba7962939d3b57682beb6dae5b608130b2e52aca78ba023cf6ce806b1dc49c72cf928a7199d22e3d7ac84e47bc9427d0236945d10dbd15177bab413fbf0edfda09f014c7a7da088dde9759702ca760af2b8e4e97cc055c617bd74c3d97008635b98dc4d621b4891da9fb0473047927',
//       e: '010001',
//     },
//   ] as [Bytes, RSAKey];

//   async('encrypt_pq', payloadPQ, (encrypted: string) => {
//     expect(encrypted).toEqual('3c140e67b01e432ab3bdd5ab48883de212401e9801d9b61032b140b6be0920b147f0a220857d2f5c1227f9712853085f9683916fc535a823b6b86b0379b0f5dca756cddd125b4c4a999da1f2b2df1391895593e603375eba383db3e4897003f71e3fee3e2e3ac9dda0273dfcdb7a51aec9955fa21646292a7185ce5fd960750c174d534842ea2c2882fe6565afec742c8d8b6178457041a3f0474065a24da91f6fe6476e451cdc947e798a4cb86442361d35da2bb2c7140d87d54a75eb37d087751d84020efe4140709ecd4749b5af63153a3b3562ca5d1b6c77a8d2aa4b9299eac74f363878c2d0ff4d33c4aed121f2338f75d6a476b4c46d1d5e682dd95c18');
//   });
// });


test('async | decrypt_dh task', () => {
  const payloadPQ = [
    '8d1e7eb7425eea7d07cb783e0dd25abdd1bd6b365a4bc46bbd219012c1cb7654b06b0e2ffe0fd3c6ecedcd6bff9f3c7784c64544dcdb32d9b9201043701d19285558d3a6374979f10f89dee317c44c25cb330e85cb572096666d73a3b54a84ac17311769b4bf9c077b993c6db22b69f9dfabd50b2f74dd795fd8fabd3156cb2af10873661af350daf8c857c0738a63442446b1d375ed7b8ce3e8d86a47680f3bfd54a1c5dffaf8abda7fa1f2d34acdc4c46bad16e54b5d23bc507076fd4909fba6c805c8bae9e76331a91867c116a7f9c18ae244274860903f7bb41b9c3d98affa03bd72eca190c28183b4045c786559bf4850668d95666c07b73e36a06c6a58a73c28dca2c2693697d0d7973d1435b8dd03c3188b4675f1a1913b3365497d93055b496ea92473114ce1e51dd593c53713c49b1e1963f848cd39e3a21d7e3d32f756eb4ababe18f90f22fb03b1a918498ff66d7914c4a6b9053b04a747d44824a90343e7904f9be8adf8dd1569fdcdce49dfb3afb0c7fb8149b4182aa4b928b0b7c8de1976dd77df612e07616be5d1134cbba9685fbf1b083415814f87c3aa07cd526fde7793c765c11b370fba666b48810a4bcb1763deeafb6b61081d10c53eb6e2cdf9f28b9d0bbe427db06573b01ca4f193fc350e4ce3b9c7fec2823ccb2d8beddf4d56c53d8e2331e10ad73a33a54b310e0db2142910169931989cdbfd4d60ede67b1ff5596a1158cb661cddbb9069b484d15f1d90a627b5f98cdea66f20886453bda8b3f51311a2f1d3ad060e53c17b4d9b9f5890a172351e3984ff0d1daf8d3ae33d06cd31f014b07995731093',
    hex('f9afe711170dcc56fd4ef98d24893ddbf4666a91699d889f26d135e33f43c80c'),
    hex('92673272f6b6ffe5c6e46b31b0a1acb9'),
  ] as [string, Bytes, Bytes];

  async('decrypt_dh', payloadPQ, (encrypted: Bytes) => {
    expect(encrypted.hex).toEqual('c0fd2f01cb38d17325bbb8cbec83dba4efc51e3fba0d89b5becffa6b21c2cb89e8f2e678eaca2adf92673272f6b6ffe5c6e46b31b0a1acb903000000fe000100c71caeb9c6b1c9048e6c522f70f13f73980d40238e3e21c14934d037563d930f48198a0aa7c14058229493d22530f4dbfa336f6e0ac925139543aed44cce7c3720fd51f69458705ac68cd4fe6b6b13abdc9746512969328454f18faf8c595f642477fe96bb2a941d5bcd1d4ac8cc49880708fa9b378e3c4f3a9060bee67cf9a4a4a695811051907e162753b56b0f6b410dba74d8a84b2a14b3144e0ef1284754fd17ed950d5965b4b9dd46582db1178d169c6bc465b0d6ff9ca3928fef5b9ae4e418fc15e83ebea0f87fa9ff5eed70050ded2849f47bf959d956850ce929851f0d8115f635b105ee2e4e15d04b2454bf6f4fadf034b10403119cd8e3b92fcc5bfe000100778e1f93735fdb98754b92bed351ea9db25c94c9cbb135b5212c29be1cf81e07b80cea64b998be5fd2af5b4e88e15746f2384545af4182bd74b0e977f0cfd091367004407befc6208402d008749f59e03696606900387175d995e895aea17a3a7d29e34ce9eb0da43718237390595cd9ec803a18b1afa065d6482c239e7142df9aa5bf090f00e21b57d4055175b748ec6668aecdc1c7f853f8c02f59764e058aa23ae6fa5e4d809298361d6dd52c6537c538a3957f91a6e9e2efb21c7a092e5a8d8baa7baa599d308f83f3945a931bfd68f31799b6c73a46bb2335fbdfa612b98992c88f60ad6192d77c9605c3db08c7ecc5a843f6cf83f90dc41eac9a76bd3b9dccc85d11217fb5d77e6d29');
  });
});
