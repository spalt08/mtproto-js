<html>
  <head>
    <script type="text/javascript" src="https://requirejs.org/docs/release/2.3.6/minified/require.js"></script> 
  </head>
  <body>
    <script type="text/javascript">
      require(['../dist/lib'], function(MTProto) {

        var tl = new MTProto.TypeLanguage(
          MTProto.Schema.MTProto, 
          MTProto.Schema.Layer105
        );

        var server = new MTProto.Http('venus.web.telegram.org', tl, {
          APIID: '1037552',
          APIHash: '98d59f55b7e29ced837ac0b549eb4b83',
          APILayer: 105,
        });

        server.connect().then(() => {
          // var q = tl.query('auth.sendCode', { 
          //   phone_number: '79296649893', 
          //   api_id: 1037552, 
          //   api_hash: ('98d59f55b7e29ced837ac0b549eb4b83'), 
          //   settings: {},
          // });

          // var q = tl.query('auth.signIn', { 
          //   phone_number: '79296649893', 
          //   phone_code_hash: '8ed7654795ba59f4a1',
          //   phone_code: '56797',
          // });

          // var q = tl.query('http_wait', {
          //   max_delay: 1000,
          //   wait_after: 5000,
          //   max_wait: 10000,
          // });

          var q = tl.create('langpack.getLanguages', {
            lang_pack: 'macos',
          });

          q.serialize();
          
          console.log(q);
          console.log(q.json());

          // server.call(q).then((res) => {
          //   var response = res[0];
          //   console.log('res', response);
          //   console.log('res', response.json());
          // });
        });

        // server.call(
        //   tl.query('help.getConfig'),
        // ).then(
        //   (res) => {
        //     console.log(res); 
        //   }
        // );

        window.m = MTProto;
        window.s = server;

        // authKey, tmpAuthKey = await server.authorize();

        // authService = new Services.Auth(transport, tl);
        // authService.getAuthKey();
        // authService.getTmpAuthKey();
        // authService.linkAuthKeys(tmp, auth);

        //MTProto.Authorize(server, tl);

        // var query = tl.query('req_pq nonce:int128 = ResPQ').randomize('nonce');

        // server.call(query, function(res) {
        //   window.res = res;
        // });

        // window.tl = tl;
        // window.m = MTProto;

        // // setTimeout(function() {
        // //   socket.send(query.compose());
        // // }, 1000);

      });
    </script>
  </body>
</html>
